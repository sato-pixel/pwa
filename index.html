<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0b57d0" />
    <title>社内ポータル｜ホーム画面に保存できます</title>
    <link rel="manifest" href="./manifest.webmanifest" />
    <link rel="icon" href="./icons/icon-192.png" />
    <style>
      body{font-family:system-ui,Roboto,sans-serif;margin:2rem;line-height:1.6;color:#222;background:#f9fafb;text-align:center}
      button{background:#0b57d0;color:white;padding:1em 1.5em;border:none;border-radius:10px;font-size:1rem;cursor:pointer;margin-top:1.5rem}
      #status{margin-top:2rem;color:#555}
    </style>
  </head>
  <body>
    <h1>社内ポータル｜ホーム画面に保存できます</h1>
    <p>会社の最新情報・連絡にアクセスするための入り口です。ホーム画面に保存しておくと、すぐに開けます。</p>
    <!-- ▼ Google Sites への導線：本番運用（ボタンのみ） -->
    <section aria-label="Official Site CTA" style="max-width:840px;margin:0 auto;text-align:center">
      <h2 style="margin:0.5rem 0 0.25rem;">社内ポータル（Google Sites）</h2>
      <p style="margin:0;color:#666">オンライン時は下のボタンから開けます。オフライン時はPWAシェルのみが表示されます。</p>
      <div style="margin-top:1rem;display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
        <a href="https://sites.google.com/nagoyagaiko.net/uyng/%E3%83%9B%E3%83%BC%E3%83%A0" class="btn-primary" style="display:inline-block;background:#1a73e8;color:#fff;padding:1em 1.4em;border-radius:10px;text-decoration:none;font-weight:600;">🌐 サイトを開く</a>
        <a href="https://sites.google.com/nagoyagaiko.net/uyng/%E3%83%9B%E3%83%BC%E3%83%A0" target="_blank" rel="noopener" class="btn-ghost" style="display:inline-block;background:#f3f6fb;color:#0b57d0;padding:1em 1.4em;border-radius:10px;text-decoration:none;font-weight:600;">↗ 新しいタブで開く（推奨）</a>
      </div>
    </section>

    <!-- ▼ ホーム画面への追加（プラットフォーム別ガイド） -->
    <section aria-label="Add to Home" style="max-width:840px;margin:2rem auto 0;text-align:left">
      <h2 style="text-align:center;margin-bottom:0.75rem">ホーム画面に追加</h2>
      <div style="border:1px solid #e5e7eb;border-radius:12px;padding:16px;background:#fff">
        <div id="a2hs-android" style="margin-bottom:12px">
          <h3 style="margin:0 0 8px">Android（Google Chrome）</h3>
          <p style="margin:0 0 8px;color:#555">条件を満たすと、下の<b>インストール</b>ボタンが表示されます。表示されない場合は、右上の <b>︙ → 「インストール」</b> または <b>「ホーム画面に追加」</b> を選択してください。</p>
          <!-- 既存の installButton をそのまま活用（beforeinstallprompt） -->
        </div>
        <div id="a2hs-ios" style="margin-top:8px">
          <h3 style="margin:0 0 8px">iPhone / iPad（Safari）</h3>
          <ol style="margin:0 0 8px 1.2rem;color:#555">
            <li>Safariで <b>https://sato-pixel.github.io/pwa/</b> を開く</li>
            <li>共有ボタン（□↑）をタップ</li>
            <li><b>ホーム画面に追加</b> を選択 → 追加</li>
          </ol>
          <p style="margin:0;color:#777;font-size:14px">※ iOSでは「インストール」ボタンは表示されません。共有メニューからの追加が標準です。</p>
        </div>
      </div>
    </section>


    <button id="installButton" hidden>インストール</button>
    <div id="status"></div>

    <script>
      // Service Worker 登録
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js').then(()=>{
          console.log('SW registered');
        }).catch(console.error);
      }

      // Install Prompt 制御
      let deferredPrompt;
      const installButton = document.getElementById('installButton');
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installButton.hidden = false;
        document.getElementById('status').textContent = 'インストール可能です！';
      });
      installButton.addEventListener('click', async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const choice = await deferredPrompt.userChoice;
        document.getElementById('status').textContent = `結果: ${choice.outcome}`;
        deferredPrompt = null;
        installButton.hidden = true;
      });
    </script>
  </body>
</html>